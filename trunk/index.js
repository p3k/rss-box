(function(){function g(){var b=d("script").filter(function(){return this.src.indexOf(a+"index.js")===0}).get(0);if(!b)return;b=d(b);var c={url:"http://blog.p3k.org/rss.xml",maxItems:7,width:200,radius:0,align:null,frameColor:"#000",titleBarColor:"#add8e6",titleBarTextColor:"#000",boxFillColor:"#fff",textColor:"#000",linkColor:"",showXmlButton:!1,compact:!1,fontFace:"auto sans-serif"},e=b.attr("src");b.attr("src",null);var f=e.indexOf("?"),l=f>-1?e.substr(f):"",o=d.deparam.querystring(l),p;for(var q in o)p=o[q],p&&p.length>0&&(q.toLowerCase().indexOf("color")>-1?c[q]=k(p):c[q]=p);c.compact==="false"&&(c.compact=!1),c.showXmlButton==="false"&&(c.showXmlButton=!1),h(c.url,function(a,d,e){var f=j(a.content||""),h=m(f,a),k=n(h,c);return b.replaceWith(k),i(h,c),c.setup==="true"&&(window.rss={xml:a.content,doc:f,data:h,config:c,renderBox:function(a,b,c){c(n(a,b)),i(a,b)}}),g()});return}function h(a,c){d.getJSON(b+"?callback=?&url="+a,c)}function i(a,b){if(a.image.source&&(!a.image.width||!a.image.height)){var c=new Image;c.src=a.image.source,d(c).load(function(){a.image.width||(a.image.width=this.width,d(".rssbox-image").css({width:this.width})),a.image.height||(a.image.height=this.height,d(".rssbox-image").css({height:this.height}))})}return}function j(a){if(a){if(document.implementation.createDocument){var b=new DOMParser,c=b.parseFromString(a,"text/xml");return c}if(window.ActiveXObject){var c=new window.ActiveXObject("Microsoft.XMLDOM");return c.async="false",c.loadXML(a),c}}return null}function k(a){if(a.indexOf("#")<0){var b=new RegExp("(^[0-9A-F]{6}$)|(^[0-9A-F]{3}$)","i");b.test(a)&&(a="#"+a)}return a.toLowerCase()}function l(a){var b=document.createElement("div");return b.appendChild(a),b.innerHTML}function m(b,c){function g(a){var b=Date.parse(a);return isNaN(b)&&(b=Date.parse(String(a).replace(e,"$1/$2/$3 $4")),isNaN(b)&&(b=Date.now())),new Date(b)}function h(){var a=null,d;if(!b||c.headers.error)a=c.headers.error===404?"File not found.":c.headers.message||"Unknown error.";else if(b.parseError&&b.parseError.errorCode)a=b.parseError.reason;else if(d=b.documentElement){var e;d.nodeName==="parsererror"?a=b.documentElement.textContent:(e=d.childNodes[0])&&e.nodeName==="parsererror"?a=e.textContent:/rss|rdf|scriptingNews/i.test(b.documentElement.nodeName)||(a="Incompatible data format. Are you sure this is an RSS feed?")}return a}function i(a){return a?String(a).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&/g,"&amp;"):""}var e=/([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9:]+).*$/,f={dc:"http://purl.org/dc/elements/1.1/",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#"},k={items:[],error:h()};k.error!==null&&(b=j(p("error",{link:a+"?"+i(c.query),message:i(k.error)})));var l=b.documentElement,m=l.nodeName,n=d(l);if(m==="scriptingNews"){var o=n.find("header");k.format="Scripting News",k.version=o.find("scriptingNewsVersion").text(),k.title=o.find("channelTitle").text(),k.description=o.find("channelDescription").text(),k.link=o.find("channelLink").text();if(ref=o.find("imageUrl").text())ref=k.image={source:ref},ref.title=o.find("imageTitle").text(),ref.link=o.find("imageLink").text(),ref.width=o.find("imageWidth").text(),ref.height=o.find("imageHeight").text(),ref.description=o.find("imageCaption").text()}else{var o=n.find("channel");k.format="RSS",k.version=m==="rdf:RDF"?"1.0":n.attr("version"),k.title=n.find("channel > title").text(),k.description=n.find("channel > description").text(),k.link=n.find("channel > link").text();var q=n.find("image");ref=k.image={source:q.find("url").text()||q.attr("rdf:resource"),title:q.find("title").text(),link:q.find("link").text(),width:q.find("width").text(),height:q.find("height").text(),description:q.find("description").text()}}if(m==="rdf:RDF"){k.date=g(o.find("dc:date")||c.headers.date),k.rights=o.find("dc:creator");var r=n.find("textinput");r.length>0&&(ref=k.input={},ref.link=r.find("link").text(),ref.description=r.find("description").text(),ref.name=r.find("name").text(),ref.title=r.find("title").text())}else k.date=g(d(o).find("lastBuildDate")||o.find("pubDate").text()||c.headers.date),k.rights=o.find("copyright").text();var s,t,u;return d(b.getElementsByTagName("item")).each(function(a){var b=d(this);if(m==="scriptingNews"){ref={title:""},ref.description=b.find("text").text().replace(/\n/g," "),ref.link=b.find("link").text();if(t=d.trim(b.find("linetext").text().replace(/\n/g," ")))ref.description=ref.description.replace(new RegExp(t),'<a href="'+b.find("url").text()+'">'+t+"</a>")}else ref={title:b.find("title").text(),description:b.find("description").text(),link:b.find("link").text()||b.find("guid").text()};if(u=b.find("source"))ref.source={link:u.attr("url"),title:u.text()};if(u=b.find("enclosure"))ref.enclosure={link:u.attr("url"),length:u.attr("length"),type:u.attr("type")};if(u=b.find("category"))ref.category={domain:u.attr("domain")||"",content:u.text()};k.items.push(ref)}),k}function n(b,c){function e(b,c){var d="";return b&&b.link&&(d+=p("image",{display:"inline",source:a+"images/attach.png",title:b.type,link:encodeURI(b.link),padding:16})),c&&c.link&&(d+=p("image",{display:"inline",source:a+"images/globe.png",title:c.title,link:encodeURI(c.link),padding:15})),d}b.error&&(c.compact=0,c.showXmlButton=1);var f,g="";for(var h=0;h<Math.min(b.items.length,c.maxItems||10);h+=1)f=b.items[h],g+=p("item",{fontWeight:c.compact?"normal":"bold",title:function(){var a="";return f.link?a+=p("link",{link:encodeURI(f.link),text:f.title,"class":"rssBoxItemTitle rssbox-item-title"}):a+=f.title,new String(a)}(),"break":f.title&&f.description?"<br>":"",description:!c.compact||!f.title?f.description:"",buttons:e(f.enclosure,f.source),textColor:c.textColor});var i="rssbox-"+Date.now(),j=p("box",{id:i,title:b.link?p("link",{link:encodeURI(b.link),text:b.title,"class":"rssBoxTitle"}):b.title,description:b.description,items:g,xmlButton:function(){return c.showXmlButton?p("image",{display:"inline-block",link:c.url,source:a+"images/rss.png",title:b.format+" "+b.version,width:16,height:16,align:"right",hspace:3,vspace:0}):""}(),image:function(){return c.compact||!b.image||!b.image.source?"":p("image",{"class":"rssbox-image",display:"inline-block",link:encodeURI(b.image.link),source:b.image.source,width:b.image.width,height:b.image.height,title:b.image.title,align:"right",valign:"baseline",hspace:5,vspace:5})}(),input:function(){if(c.compact||!b.input)return"";p("input",{link:encodeURI(b.input.link),description:b.input.description,name:b.input.name,title:b.input.title})}(),date:o(b.date),width:c.width,frameColor:c.frameColor,fontFace:c.fontFace,align:c.align,titleBarColor:c.titleBarColor,titleBarTextColor:c.titleBarTextColor,boxFillColor:c.boxFillColor,textColor:c.textColor,radius:c.radius}),k=p("stylesheet",{id:i,width:c.width,frameColor:c.frameColor,fontFace:c.fontFace,align:c.align,radius:c.radius,titleBarTextColor:c.titleBarTextColor,titleBarColor:c.titleBarColor,boxFillColor:c.boxFillColor,textColor:c.textColor,linkColor:c.linkColor}),l=document.createElement("style");return d("head").prepend(l),l.type="text/css",l.rel="stylesheet",l.media="screen",l.styleSheet?l.styleSheet.cssText=k:d(l).text(k),j}function o(a){function b(a){return a<10?"0"+a:a}return p("date",{year:a.getFullYear(),month:b(a.getMonth()+1),day:b(a.getDate()),hours:b(a.getHours()),minutes:b(a.getMinutes()),seconds:b(a.getSeconds()),timeZone:""})}function p(a,b){var c=q(a);return c&&b?c.replace(/\$\{([^}]+)\}/g,function(){var a=arguments[1];return b[a]}):""}function q(a){return d.trim(e.filter(function(){return d(this).hasClass("template")&&d(this).hasClass(a)}).html())}var a="http://p3k.org/rss/",b="http://3.p3k-001.appspot.com/roxy",c="http://3.p3k-001.appspot.com/ferris?callback=?&group=rssbox";if(window._rss_box_framework_has_loaded)return;window._rss_box_framework_has_loaded=!0,Date.now||(Date.now=function(){return(new Date).valueOf()});var d,e,f=document.createElement("script");f.type="text/javascript",f.src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js",f.onload=function(){jQuery.getScript(a+"jquery.ba-bbq.min.js",function(){jQuery.noConflict(),d=jQuery,h(a+"templates.inc",function(b){e=jQuery(b.content),g(),location.href.indexOf(a)<0&&d.getJSON(c+"&url="+encodeURIComponent(location.href))})})},f.onreadystatechange=function(){f.readyState==="loaded"&&f.onload()},document.body.appendChild(f)})()